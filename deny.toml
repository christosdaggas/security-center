# cargo-deny configuration for supply chain security
# Run: cargo install cargo-deny && cargo deny check

[advisories]
db-path = "~/.cargo/advisory-db"
db-urls = ["https://github.com/rustsec/advisory-db"]
vulnerability = "deny"
unmaintained = "warn"
yanked = "warn"
notice = "warn"

# Ignore specific advisories if needed (add with justification)
# ignore = [
#     "RUSTSEC-XXXX-YYYY",  # Reason for ignoring
# ]

[licenses]
unlicensed = "deny"
copyleft = "warn"
allow = [
    "MIT",
    "Apache-2.0",
    "Apache-2.0 WITH LLVM-exception",
    "BSD-2-Clause",
    "BSD-3-Clause",
    "ISC",
    "Zlib",
    "Unicode-DFS-2016",
    "MPL-2.0",
    "CC0-1.0",
]

# Confidence threshold for license detection
confidence-threshold = 0.8

[licenses.private]
# Private crates don't need to match licenses
ignore = true

[bans]
# Lint level for when multiple versions of the same crate are detected
multiple-versions = "warn"
# Lint level for when a crate is detected with a wildcard version
wildcards = "deny"
# Allow specific crates to have multiple versions
skip = [
    # Often has multiple versions due to ecosystem fragmentation
    # { name = "syn", version = "*" },
]
# Deny specific crates
deny = [
    # Example: { name = "openssl", wrappers = ["openssl"] },
]

[bans.build]
# Deny build scripts that modify files outside of OUT_DIR
allow-build-scripts = [
    "gtk4-sys",
    "glib-sys",
    "cairo-sys-rs",
    "pango-sys",
    "gdk4-sys",
    "libadwaita-sys",
    "graphene-sys",
]

[sources]
unknown-registry = "deny"
unknown-git = "deny"
# Allow only crates.io
allow-registry = ["https://github.com/rust-lang/crates.io-index"]
# Allow specific git repositories if needed
# allow-git = []

[sources.allow-org]
# Allow all crates from specific organizations
github = []
